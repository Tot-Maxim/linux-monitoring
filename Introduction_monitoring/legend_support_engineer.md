# Легенда инженера по сопровождению ПО, работающего в отделе мониторинга

---

#### 1. **Общая информация о работе и отделе**
Я работаю инженером по сопровождению ПО в отделе мониторинга уже около двух лет. Наш отдел отвечает за обеспечение стабильной работы критически важных сервисов компании, а также за своевременное выявление и устранение инцидентов. Мы активно используем современные инструменты для мониторинга, автоматизации и управления инфраструктурой. 

Моя основная задача — поддерживать работоспособность всех систем, решать возникающие инциденты, внедрять релизы и следить за качеством работы серверов и приложений.

---

#### 2. **Распорядок дня**
Каждый день начинается с ежедневной встречи (дейлик: daily stand-up) с начальством и командой. На этой встрече мы обсуждаем текущие инциденты, задачи на день, а также прогресс по внедрению новых релизов. После этого я проверяю дашборды в Grafana, чтобы убедиться, что все метрики в пределах нормы. Если есть какие-либо аномалии или инциденты, я сразу же начинаю их расследование.

Основные задачи дня:
- Мониторинг состояния систем через Prometheus и Grafana.
- Решение инцидентов, которые могут возникнуть в процессе работы.
- Подготовка и внедрение релизов через CI/CD-пайплайны.
- Взаимодействие с разработчиками для устранения проблем в коде.
- Участие в совещаниях по оптимизации инфраструктуры.

---

#### 3. **Стек отдела**
Наш отдел использует следующий стек технологий:

**Мониторинг:**
- **Grafana**: Для визуализации метрик и создания дашбордов.
- **Prometheus**: Для сбора метрик с серверов и приложений.
- **Node Exporter**: Для мониторинга состояния серверов.
- **Blackbox Exporter**: Для проверки доступности сервисов (HTTP, TCP, ICMP).
- **Nginx Exporter**: Для мониторинга производительности Nginx.
- **Postgres Exporter**: Для мониторинга баз данных PostgreSQL.

**Серверы:**
- **Nginx**: Балансировка нагрузки и проксирование трафика.
- **Kubernetes (k8s)**: Оркестрация контейнеров.
- **OpenShift**: Платформа для управления контейнерами.

**CI/CD:**
- **TeamCity**: Автоматизация сборки и тестирования.
- **Ansible**: Конфигурационное управление.
- **Docker**: Контейнеризация приложений.
- **Terraform**: Управление инфраструктурой как кодом.

**ОС:**
- **Debian**: Используется в разрезе стенда DEV в качестве песочницы.
- **CentOS**: Основная операционная система для серверов.

---

#### 4. **Вопросы к каждому инструменту**

##### **Grafana**
1. Как вы настраивали дашборды для мониторинга критических метрик?
   - Ответ: Я создавал дашборды, которые показывают использование CPU, RAM, дискового пространства и сетевой активности. Также добавлял графики для HTTP-статусов и времени отклика сервисов.

2. Как вы организовывали уведомления?
   - Ответ: Мы настроили алерты через Alertmanager, которые отправляют уведомления в Telegram и email, если метрики выходят за допустимые пределы.

3. Как вы решали проблемы с производительностью дашбордов?
   - Ответ: Оптимизировал запросы к Prometheus, уменьшая количество данных, которые нужно обрабатывать, и использовал агрегацию метрик.

4. Как вы интегрировали Grafana с другими инструментами?
   - Ответ: Мы интегрировали Grafana с Prometheus для сбора метрик и с Blackbox Exporter для мониторинга доступности сервисов.

5. Как вы обеспечивали безопасность дашбордов?
   - Ответ: Настроил RBAC (Role-Based Access Control), чтобы ограничить доступ к дашбордам только для авторизованных пользователей.

---

##### **Prometheus**
1. Как вы собирали метрики с серверов?
   - Ответ: Использовал Node Exporter для сбора метрик с серверов и настраивал scrape jobs в конфигурации Prometheus.

2. Как вы решали проблемы с нехваткой места для хранения метрик?
   - Ответ: Настроил retention policies и использовал компрессию данных для уменьшения объема хранимых метрик.

3. Как вы организовывали alerting?
   - Ответ: Создавал правила в Prometheus Rules для мониторинга критических метрик, таких как использование CPU выше 90% или недоступность сервисов.

4. Как вы решали проблемы с высокой нагрузкой на Prometheus?
   - Ответ: Добавлял больше серверов для шардинга данных и настраивал federation для распределенного сбора метрик.

5. Как вы тестировали новые правила алертинга?
   - Ответ: Использовал Prometheus Recording Rules для тестирования правил перед их применением в продакшене.

---

##### **Nginx**
1. Как была реализована балансировка нагрузки?
   - Ответ: Мы использовали Nginx с алгоритмом round-robin для равномерного распределения трафика между серверами.

2. Как вы решали проблемы с медленными ответами?
   - Ответ: Анализировал логи Nginx и оптимизировал конфигурацию keepalive и timeout.

3. Как вы настраивали мониторинг Nginx?
   - Ответ: Использовал Nginx Exporter для сбора метрик, таких как количество запросов, время отклика и ошибки.

4. Как вы обеспечивали безопасность Nginx?
   - Ответ: Настроил SSL/TLS, ограничил доступ по IP и использовал WAF для защиты от атак.

5. Как вы решали проблемы с падением Nginx?
   - Ответ: Анализировал логи и добавлял health checks для автоматического перезапуска.

---

##### **Kubernetes**
1. Как вы решали проблемы с деплоем приложений?
   - Ответ: Проверял логи подов и настраивал readiness probes для корректного старта приложений.

2. Как вы мониторили состояние кластера?
   - Ответ: Использовал Prometheus для сбора метрик с kube-state-metrics и Grafana для визуализации.

3. Как вы решали проблемы с производительностью кластера?
   - Ответ: Оптимизировал использование ресурсов через resource requests и limits.

4. Как вы настраивали CI/CD для Kubernetes?
   - Ответ: Использовал TeamCity для сборки образов Docker и Helm для деплоя в Kubernetes.

5. Как вы решали проблемы с нехваткой ресурсов?
   - Ответ: Добавлял новые ноды в кластер и настраивал autoscaling.

---

##### **TeamCity**
1. Как вы настраивали пайплайны для сборки проектов?
   - Ответ: Использовал build steps для выполнения команд сборки, тестирования и деплоя.

2. Как вы решали проблемы с зависанием билдов?
   - Ответ: Анализировал логи и увеличивал таймауты для длительных задач.

3. Как вы организовывали уведомления о статусе билдов?
   - Ответ: Настроил интеграцию с Slack для отправки уведомлений о завершении билдов.

4. Как вы решали проблемы с нехваткой ресурсов агентов?
   - Ответ: Добавлял новые агенты и настраивал параллельное выполнение задач.

5. Как вы тестировали новые пайплайны?
   - Ответ: Запускал тестовые билды в отдельной ветке перед деплоем в продакшен.

---

#### 5. **Заключение**
На собеседовании я могу детально рассказать о каждом из инструментов, которые использую в работе, и о том, как они помогают мне эффективно решать задачи. Я уверен, что мой опыт и знания будут полезны вашей команде.
